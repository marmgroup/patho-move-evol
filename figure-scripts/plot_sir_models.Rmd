---
editor_options: 
  chunk_output_type: console
---
  
# Plot networks and SIR models
  
```{r}
library(data.table)
library(ggplot2)

library(patchwork)
library(colorspace)
```

```{r}
labels = c(
  "nopatho" = "Sc. 1: No pathogen",
  "endemic" = "Sc. 2: Endemic pathogen",
  "spillover" = "Sc. 3: Spillover pathogen"
)
```


## Basic scenarios

```{r}
sir_basic = fread("data/results/data_sir_basic.csv")
# sir_basic$mean = sir_basic$mean / 500
sir_basic = sir_basic[gamma == 1]
# sir_basic[, tround := atanh(time)]
sir_basic$scenario = factor(sir_basic$scenario, 
                            levels = c("nopatho", "endemic"))
```

```{r}
ggplot(sir_basic[class %in% c("NR")])+
  geom_jitter(
    aes(
      time, mean,
      col = as.factor(beta)
    ),
    alpha = 0.2
  )+
  # geom_bin2d(
  #   aes(
  #     time, mean
  #   ),
  #   binwidth = c(0.1, 10)
  # )+
  scale_fill_continuous_sequential(
    palette = "Plasma",
    trans = "log10"
  )+
  scale_y_sqrt()+
  scale_x_continuous(
    trans = ggallin::pseudolog10_trans
  )+
  facet_grid(~scenario, scales = "free_y")
```


## Spillover

```{r}
# spillover data and rounding
sir_spillover = fread("data/results/data_sir_spillover.csv")
# sir_spillover$mean = sir_spillover$mean / 500
sir_spillover = sir_spillover[gamma == 1 & beta == 5]


sir_spillover[, tround := atanh(time)]
sir_spillover[, tround := fifelse(tround < 1, round(tround, 1), round(tround, 1))]
```

```{r}
ggplot(sir_spillover[class %in% c("NR")])+
  geom_bin2d(
    aes(
      time, mean
    ),
    binwidth = c(0.1, 10)
  )+
  # stat_summary(
  #   fun.data = mean_se,
  #   aes(tround, mean,
  #       group = interaction(class),
  #       col = class),
  #   # geom = "point",
  #   # alpha = 0.2
  # )+
  scale_fill_continuous_sequential(
    palette = "Plasma",
    trans = "log10"
  )+
  # scale_x_continuous(
  #   trans = ggallin::pseudolog10_trans
  # )+
  # scale_x_sqrt()+
  # scale_y_sqrt()+
  facet_grid(~type, scales = "free_y")
```

